import{B as e}from"./index.esm-BEZ9wTek.js";import{a as t,c as o}from"./parallelogram-demo.min.js";class l extends e{_getSelector(){return"data-modal"}static get defaults(){return{size:"md",closable:!0,backdropClose:!0,keyboard:!0,focus:!0,multiple:!1,appendTo:"body"}}_init(e){const t=super._init(e),o=this.getAttr(e,"target"),a=this.getAttr(e,"size",l.defaults.size),i=this.getAttr(e,"closable",l.defaults.closable),d=this.getAttr(e,"backdrop-close",l.defaults.backdropClose),n=this.getAttr(e,"keyboard",l.defaults.keyboard),s=this.getAttr(e,"focus",l.defaults.focus),r=this.getAttr(e,"multiple",l.defaults.multiple);if(!o)return this.logger?.warn("Modal: No data-modal-target attribute found",e),t;let m=document.querySelector(o);return m?"p-modal"!==m.tagName.toLowerCase()?(this.logger?.warn("Modal: Target is not an p-modal element",{target:o,element:e}),t):(this._configureModal(m,{size:a,closable:i,backdropClose:d,keyboard:n}),t.target=o,t.modalElement=m,t.size=a,t.closable=i,t.backdropClose=d,t.keyboard=n,t.focus=s,t.multiple=r,e.addEventListener("click",this._handleTriggerClick.bind(this,e),{signal:t.controller.signal}),m.addEventListener("modal:open",this._handleModalOpen.bind(this,e),{signal:t.controller.signal}),m.addEventListener("modal:close",this._handleModalClose.bind(this,e),{signal:t.controller.signal}),e.setAttribute("aria-haspopup","dialog"),e.setAttribute("aria-expanded","false"),e.getAttribute("aria-controls")||e.setAttribute("aria-controls",o.replace("#","")),this.logger?.info("Modal trigger initialized",{element:e,target:o,size:a,closable:i}),t):(this.logger?.warn("Modal: Target modal not found",{target:o,element:e}),t)}open(e){const t=this.getState(e);t?.modalElement&&(t.multiple||this._closeOtherModals(t.modalElement),t.modalElement._triggerElement=e,"function"==typeof t.modalElement.open?t.modalElement.open():customElements.whenDefined("p-modal").then(()=>{"function"==typeof t.modalElement.open?t.modalElement.open():this.logger?.error("PModal open method not available",t.modalElement)}))}close(e){const t=this.getState(e);t?.modalElement&&("function"==typeof t.modalElement.close?t.modalElement.close():this.logger?.error("PModal close method not available",t.modalElement))}toggle(e,t){const o=this.getState(e);o?.modalElement&&(!0===t?this.open(e):!1===t||o.modalElement.hasAttribute("open")?this.close(e):this.open(e))}isOpen(e){const t=this.getState(e);return t?.modalElement?.hasAttribute("open")||!1}_configureModal(e,t){t.size&&this.setAttr(e,"size",t.size),void 0!==t.closable&&this.setAttr(e,"closable",String(t.closable)),void 0!==t.backdropClose&&this.setAttr(e,"backdrop-close",String(t.backdropClose)),void 0!==t.keyboard&&this.setAttr(e,"keyboard",String(t.keyboard))}_handleTriggerClick(e,t){t.preventDefault(),this.open(e)}_handleModalOpen(e,t){e.setAttribute("aria-expanded","true"),this._dispatch(e,"modal:opened",{trigger:e,modal:t.detail.modal}),this.eventBus?.emit("modal:opened",{trigger:e,modal:t.detail.modal}),this.logger?.info("Modal opened",{triggerElement:e,modal:t.detail.modal})}_handleModalClose(e,t){e.setAttribute("aria-expanded","false");const o=this.getState(e);o?.focus&&t.detail.modal._triggerElement&&requestAnimationFrame(()=>{t.detail.modal._triggerElement.focus()}),this._dispatch(e,"modal:closed",{trigger:e,modal:t.detail.modal}),this.eventBus?.emit("modal:closed",{trigger:e,modal:t.detail.modal}),this.logger?.info("Modal closed",{triggerElement:e,modal:t.detail.modal})}_closeOtherModals(e){document.querySelectorAll("p-modal[open]").forEach(t=>{t!==e&&t.close()})}updateConfig(e,t){const o=this.getState(e);o?.modalElement&&(Object.assign(o,t),this._configureModal(o.modalElement,t),this.logger?.info("Modal configuration updated",{triggerElement:e,newConfig:t}))}static enhanceAll(e="[data-modal][data-modal-target]",t){const o=new l(t);return document.querySelectorAll(e).forEach(e=>{o.mount(e)}),o}static async create({title:e,content:l,actions:a=[],size:i="medium",options:d={}}){const n=document.createElement("p-modal");if(n.id=t("modal"),n.setAttribute("data-modal-size",i),Object.entries(d).forEach(([e,t])=>{n.setAttribute(`data-modal-${e}`,String(t))}),e){const t=o("h2",{slot:"title"},e);n.appendChild(t)}if(l){const e=document.createElement("div");e.innerHTML=l,n.appendChild(e)}if(a.length>0){const e=document.createElement("div");e.slot="actions",a.forEach(t=>{const l=o("button",{className:`btn btn--${t.type||"secondary"}`,"data-modal-close":!1!==t.close?"":void 0},t.label);t.onClick&&l.addEventListener("click",t.onClick),e.appendChild(l)}),n.appendChild(e)}document.body.appendChild(n)}}export{l as default};
