import{B as t}from"./index.esm-BEZ9wTek.js";import{a as e}from"./parallelogram-demo.min.js";class a extends t{_getSelector(){return"data-tabs"}static get defaults(){return{activeClass:"tab--active",panelActiveClass:"tab-panel--active",defaultTab:null,keyboardNavigation:!0,autoFocus:!1,transitionDuration:200,transitionClass:"tab-panel--transitioning"}}_init(t){const e=super._init(t),s=t.querySelector("[data-tabs-list]"),n=t.querySelector("[data-tabs-panels]");if(!s||!n)return this.logger?.warn("Tabs: Missing required elements (data-tabs-list or data-tabs-panels)",t),e;const i=[...s.querySelectorAll("[data-tab]")],r=[...n.querySelectorAll("[data-tab-panel]")];if(0===i.length||0===r.length)return this.logger?.warn("Tabs: No tabs or panels found",t),e;const l=this.getAttr(t,"default-tab",a.defaults.defaultTab),o=this.getAttr(t,"keyboard",a.defaults.keyboardNavigation),c=this.getAttr(t,"autofocus",a.defaults.autoFocus);e.tabsList=s,e.tabsContainer=n,e.tabs=i,e.panels=r,e.activeTab=null,e.activePanel=null,e.keyboardNavigation=o,e.autoFocus=c,this._setupTabs(t,e);const b=this._getInitialTab(i,l);b&&this._activateTab(t,b.dataset.tab,e,!1),this._setupEventListeners(t,e),this.setAttr(t,"enhanced","true"),t.classList.add("tabs--enhanced");const d=e.cleanup;return e.cleanup=()=>{this._removeEventListeners(t,e),this.removeAttr(t,"enhanced"),t.classList.remove("tabs--enhanced"),d()},this.eventBus?.emit("tabs:mount",{element:t,tabCount:i.length,panelCount:r.length,timestamp:performance.now()}),this.logger?.info("Tabs initialized",{element:t,tabCount:i.length,panelCount:r.length}),e}_setupTabs(t,a){a.tabs.forEach((t,s)=>{t.setAttribute("role","tab"),t.setAttribute("tabindex","-1"),t.id||(t.id=e("tab"));const n=t.dataset.tab,i=a.panels.find(t=>t.id===n);i&&(i.setAttribute("role","tabpanel"),i.setAttribute("aria-labelledby",t.id),i.setAttribute("tabindex","0"),i.getAttribute("data-tab-panel")||i.setAttribute("data-tab-panel","inactive"))}),a.tabsList.setAttribute("role","tablist")}_getInitialTab(t,e){const a=t.find(t=>"true"===t.getAttribute("aria-selected"));if(a)return a;if(e){const a=t.find(t=>t.dataset.tab===e);if(a)return a}return t[0]}_setupEventListeners(t,e){e.clickHandlers=new Map,e.keydownHandlers=new Map,e.tabs.forEach(a=>{const s=a=>this._handleTabClick(a,t,e),n=a=>this._handleKeyDown(a,t,e);a.addEventListener("click",s),e.keyboardNavigation&&a.addEventListener("keydown",n),e.clickHandlers.set(a,s),e.keydownHandlers.set(a,n)})}_removeEventListeners(t,e){e.clickHandlers&&e.clickHandlers.forEach((t,e)=>{e.removeEventListener("click",t)}),e.keydownHandlers&&e.keydownHandlers.forEach((t,e)=>{e.removeEventListener("keydown",t)})}_handleTabClick(t,e,a){t.preventDefault();const s=t.currentTarget.dataset.tab;s&&s!==a.activeTab&&this._activateTab(e,s,a,!0)}_handleKeyDown(t,e,a){const s=a.tabs.findIndex(e=>e===t.currentTarget);let n=-1;switch(t.key){case"ArrowRight":case"ArrowDown":t.preventDefault(),n=(s+1)%a.tabs.length;break;case"ArrowLeft":case"ArrowUp":t.preventDefault(),n=(s-1+a.tabs.length)%a.tabs.length;break;case"Home":t.preventDefault(),n=0;break;case"End":t.preventDefault(),n=a.tabs.length-1;break;case"Enter":case" ":t.preventDefault();const i=t.currentTarget.dataset.tab;return void this._activateTab(e,i,a,!0)}if(n>=0){const t=a.tabs[n];a.autoFocus&&t.focus(),this._activateTab(e,t.dataset.tab,a,!0)}}async _activateTab(t,e,a,s=!0){const n=a.tabs.find(t=>t.dataset.tab===e),i=a.panels.find(t=>t.id===e);if(!n||!i)return void this.logger?.warn("Tabs: Invalid tab or panel ID",{panelId:e,element:t});const r=a.activeTab,l=a.activePanel;a.tabs.forEach(t=>{const a=t.dataset.tab===e;t.setAttribute("aria-selected",a?"true":"false"),t.setAttribute("tabindex",a?"0":"-1")}),s&&l&&l!==i?await this._transitionPanels(l,i,a):a.panels.forEach(t=>{const a=t.id===e;t.style.display=a?"":"none",t.setAttribute("data-tab-panel",a?"active":"inactive")}),a.activeTab=e,a.activePanel=i,a.autoFocus&&n.focus(),this._dispatch(t,"tabs:change",{activeTab:e,previousTab:r,tab:n,panel:i}),this.eventBus?.emit("tabs:change",{element:t,activeTab:e,previousTab:r,tab:n,panel:i,timestamp:performance.now()}),this.logger?.debug("Tab activated",{panelId:e,previousTab:r})}async _transitionPanels(t,e,s){const n=a.defaults.transitionDuration;t.setAttribute("data-tab-panel","transitioning"),e.setAttribute("data-tab-panel","transitioning"),e.style.display="",t.style.opacity="0",await new Promise(t=>setTimeout(t,n/2)),t.style.display="none",t.setAttribute("data-tab-panel","inactive"),t.style.opacity="",e.style.opacity="0",requestAnimationFrame(()=>{e.style.transition=`opacity ${n}ms ease-in-out`,e.style.opacity="1"}),setTimeout(()=>{e.style.transition="",e.style.opacity="",e.setAttribute("data-tab-panel","active")},n)}activateTab(t,e){const a=this.getState(t);a&&this._activateTab(t,e,a,!0)}getActiveTab(t){const e=this.getState(t);return e?e.activeTab:null}getStatus(){const t=document.querySelectorAll("[data-tabs]"),e=[];let s=0,n=0;return t.forEach(t=>{const a=this.getState(t);a&&this.hasAttr(t,"enhanced")&&(e.push(t),s+=a.tabs.length,n+=a.panels.length)}),{containers:e.length,totalTabs:s,totalPanels:n,keyboardNavigationSupported:!0,defaults:a.defaults}}static enhanceAll(t="[data-tabs]",e){const s=new a(e);return document.querySelectorAll(t).forEach(t=>{s.mount(t)}),s}}export{a as default};
