import{B as e}from"./parallelogram-demo.min.js";class t extends e{constructor(e={}){super(e),this.mediaMetrics={imagesLoaded:0,totalLoadTime:0,activeComponents:0,componentsCleaned:0}}_init(e){const t=super._init(e);return console.log("DemoMedia component initializing for element:",e),this.element=e,this.setupEventListeners(t),this.setupButtonHandlers(t),this.initializeMetricsDisplay(),this.notifyPageLoaded(),this.eventBus&&this.eventBus.emit("demo-media:mounted",{element:e}),t}setupEventListeners(e){const{controller:t}=e;document.addEventListener("click",e=>{this.handleGalleryClick(e)},{signal:t.signal}),document.addEventListener("lazysrc:loaded",e=>{console.log("lazysrc:loaded event received",e.detail),this.mediaMetrics.imagesLoaded++,e.detail&&e.detail.loadTime&&(this.mediaMetrics.totalLoadTime+=e.detail.loadTime),this.updateMetricsDisplay(),window.Toast&&window.Toast.show&&window.Toast.show("Image loaded successfully","success")},{signal:t.signal}),document.addEventListener("lazysrc:loading-start",e=>{this.updateMetricsDisplay()},{signal:t.signal}),document.addEventListener("lazysrc:detached",e=>{this.mediaMetrics.componentsCleaned++,this.updateMetricsDisplay()},{signal:t.signal}),document.addEventListener("carousel:slide-change",e=>{console.log("Carousel slide changed:",e.detail)},{signal:t.signal})}setupButtonHandlers(e){const{controller:t}=e;this.element.querySelectorAll('[data-btn-action="downloadCurrentImage"]').forEach(e=>{e.addEventListener("click",()=>this.downloadCurrentImage(),{signal:t.signal})})}handleGalleryClick(e){const t=e.target.closest("[data-gallery-item]");if(t){const e=t.querySelector("img"),i=e.getAttribute("data-gallery-full"),a=e.getAttribute("alt"),s=document.getElementById("gallery-preview-image");s.src=i,s.alt=a}}downloadCurrentImage(){const e=document.getElementById("gallery-preview-image");if(e.src){const t=document.createElement("a");t.href=e.src,t.download="gallery-image.jpg",document.body.appendChild(t),t.click(),document.body.removeChild(t)}}updateMetricsDisplay(){const e=document.getElementById("images-loaded");e&&(e.textContent=this.mediaMetrics.imagesLoaded);const t=document.getElementById("avg-load-time");t&&(t.textContent=this.mediaMetrics.imagesLoaded>0?Math.round(this.mediaMetrics.totalLoadTime/this.mediaMetrics.imagesLoaded)+"ms":"0ms");const i=document.getElementById("active-components");if(i){const e=document.querySelectorAll("[data-lazysrc]:not([data-lazysrc-complete])").length;i.textContent=e}const a=document.getElementById("memory-saved");a&&(a.textContent=this.mediaMetrics.componentsCleaned)}initializeMetricsDisplay(){console.log("Initializing metrics display"),this.updateMetricsDisplay()}notifyPageLoaded(){window.eventBus&&window.eventBus.emit("page:loaded",{page:"/media",components:["lazysrc","carousel","modal"],timestamp:performance.now()})}emit(e,t){this.eventBus&&this.eventBus.emit(e,t)}getMediaMetrics(){return{...this.mediaMetrics}}resetMetrics(){this.mediaMetrics={imagesLoaded:0,totalLoadTime:0,activeComponents:1,componentsCleaned:0},this.updateMetricsDisplay()}}export{t as DemoMedia};
