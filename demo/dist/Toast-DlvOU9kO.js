import{B as t}from"./index.esm-BEZ9wTek.js";class e extends t{_getSelector(){return"data-toast"}static get defaults(){return{defaultDuration:4e3,defaultType:"info",fadeOutDuration:300,typeMapping:{info:"info",success:"success",warn:"warning",warning:"warning",error:"error",danger:"error"}}}_init(t){const s=super._init(t),a=this.getAttr(t,"message"),r=this.getAttr(t,"trigger",e.defaults.defaultType),i=parseInt(this.getAttr(t,"duration",e.defaults.defaultDuration)),o=this.getAttr(t,"title"),n="false"!==this.getAttr(t,"dismissible","true");if(!t.hasAttribute("data-toast-trigger"))return this.logger?.warn("Toast component mounted on element without data-toast-trigger attribute",t),s;if(!a)return this.logger?.warn("Toast trigger missing data-toast-message attribute",t),s;s.message=a,s.type=r,s.duration=i,s.title=o,s.dismissible=n;const l=e=>this._handleClick(e,t);t.addEventListener("click",l),t.setAttribute("data-toast-enhanced","true"),t.classList.add("toast-trigger--enhanced");const g=s.cleanup;return s.cleanup=()=>{t.removeEventListener("click",l),t.removeAttribute("data-toast-enhanced"),t.classList.remove("toast-trigger--enhanced"),g()},this.eventBus?.emit("toast:mount",{element:t,message:a,type:r,timestamp:performance.now()}),this.logger?.debug("Toast trigger initialized",{element:t,message:a,type:r,duration:i}),s}_handleClick(t,s){t.preventDefault();const a=this.getState(s);if(!a)return void this.logger?.warn("Toast trigger clicked but no state found",s);const r=e.defaults.typeMapping[a.type]||a.type;this._showToast({message:a.message,type:r,duration:a.duration,title:a.title,dismissible:a.dismissible,trigger:s})}_showToast(t){const{message:s,type:a=e.defaults.defaultType,duration:r=e.defaults.defaultDuration,title:i,dismissible:o=!0,trigger:n}=t;try{if(window.alertManager&&"function"==typeof window.alertManager.show)window.alertManager.show({message:s,type:a,duration:r,title:i,dismissible:o});else{const t=document.querySelector("p-toasts");t&&"function"==typeof t.toast?t.toast({message:s,type:a,duration:r,title:i,dismissible:o}):(this.logger?.warn("No toast system available, falling back to alert"),alert(`${a.toUpperCase()}: ${i?i+"\n":""}${s}`))}this._dispatch(n,"toast:shown",{message:s,type:a,duration:r,title:i}),this.eventBus?.emit("toast:show",{message:s,type:a,duration:r,title:i,trigger:n,timestamp:performance.now()}),this.logger?.info("Toast shown",{message:s,type:a,duration:r,title:i})}catch(e){this.logger?.error("Failed to show toast",e),this._dispatch(n,"toast:error",{error:e.message,message:s,type:a}),this.eventBus?.emit("toast:error",{error:e.message,options:t,trigger:n,timestamp:performance.now()}),alert(`${a.toUpperCase()}: ${i?i+"\n":""}${s}`)}}static show(t,s="info",a={}){(new e)._showToast({message:t,type:s,...a})}getStatus(){return{mountedTriggers:document.querySelectorAll('[data-toast-enhanced="true"]').length,availableTypes:Object.keys(e.defaults.typeMapping),alertManagerAvailable:!(!window.alertManager||"function"!=typeof window.alertManager.show),xToastsAvailable:!!document.querySelector("p-toasts"),defaults:e.defaults}}static enhanceAll(t="[data-toast-trigger][data-toast-message]",s){const a=new e(s);return document.querySelectorAll(t).forEach(t=>{a.mount(t)}),a}}export{e as default};
