import{B as e}from"./index.esm-BW_QP_AR.js";import{a as t,c as a}from"./parallelogram-demo.min.js";class o extends e{static get defaults(){return{size:"md",closable:!0,backdropClose:!0,keyboard:!0,focus:!0,multiple:!1,appendTo:"body"}}_init(e){const t=super._init(e),a=this._getDataAttr(e,"modal-target"),l=this._getDataAttr(e,"modal-size",o.defaults.size),d=this._getDataAttr(e,"modal-closable",o.defaults.closable),i=this._getDataAttr(e,"modal-backdrop-close",o.defaults.backdropClose),n=this._getDataAttr(e,"modal-keyboard",o.defaults.keyboard),s=this._getDataAttr(e,"modal-focus",o.defaults.focus),r=this._getDataAttr(e,"modal-multiple",o.defaults.multiple);if(!a)return this.logger?.warn("Modal: No data-modal-target attribute found",e),t;let m=document.querySelector(a);return m?"p-modal"!==m.tagName.toLowerCase()?(this.logger?.warn("Modal: Target is not an p-modal element",{target:a,element:e}),t):(this._configureModal(m,{size:l,closable:d,backdropClose:i,keyboard:n}),t.target=a,t.modalElement=m,t.size=l,t.closable=d,t.backdropClose=i,t.keyboard=n,t.focus=s,t.multiple=r,e.addEventListener("click",this._handleTriggerClick.bind(this,e),{signal:t.controller.signal}),m.addEventListener("modal:open",this._handleModalOpen.bind(this,e),{signal:t.controller.signal}),m.addEventListener("modal:close",this._handleModalClose.bind(this,e),{signal:t.controller.signal}),e.setAttribute("aria-haspopup","dialog"),e.setAttribute("aria-expanded","false"),e.getAttribute("aria-controls")||e.setAttribute("aria-controls",a.replace("#","")),this.logger?.info("Modal trigger initialized",{element:e,target:a,size:l,closable:d}),t):(this.logger?.warn("Modal: Target modal not found",{target:a,element:e}),t)}open(e){const t=this.getState(e);t?.modalElement&&(t.multiple||this._closeOtherModals(t.modalElement),t.modalElement._triggerElement=e,"function"==typeof t.modalElement.open?t.modalElement.open():customElements.whenDefined("p-modal").then(()=>{"function"==typeof t.modalElement.open?t.modalElement.open():this.logger?.error("PModal open method not available",t.modalElement)}))}close(e){const t=this.getState(e);t?.modalElement&&("function"==typeof t.modalElement.close?t.modalElement.close():this.logger?.error("PModal close method not available",t.modalElement))}toggle(e,t){const a=this.getState(e);a?.modalElement&&(!0===t?this.open(e):!1===t||a.modalElement.hasAttribute("open")?this.close(e):this.open(e))}isOpen(e){const t=this.getState(e);return t?.modalElement?.hasAttribute("open")||!1}_configureModal(e,t){t.size&&e.setAttribute("data-modal-size",t.size),void 0!==t.closable&&e.setAttribute("data-modal-closable",String(t.closable)),void 0!==t.backdropClose&&e.setAttribute("data-modal-backdrop-close",String(t.backdropClose)),void 0!==t.keyboard&&e.setAttribute("data-modal-keyboard",String(t.keyboard))}_handleTriggerClick(e,t){t.preventDefault(),this.open(e)}_handleModalOpen(e,t){e.setAttribute("aria-expanded","true"),this._dispatch(e,"modal:opened",{trigger:e,modal:t.detail.modal}),this.eventBus?.emit("modal:opened",{trigger:e,modal:t.detail.modal}),this.logger?.info("Modal opened",{triggerElement:e,modal:t.detail.modal})}_handleModalClose(e,t){e.setAttribute("aria-expanded","false");const a=this.getState(e);a?.focus&&t.detail.modal._triggerElement&&requestAnimationFrame(()=>{t.detail.modal._triggerElement.focus()}),this._dispatch(e,"modal:closed",{trigger:e,modal:t.detail.modal}),this.eventBus?.emit("modal:closed",{trigger:e,modal:t.detail.modal}),this.logger?.info("Modal closed",{triggerElement:e,modal:t.detail.modal})}_closeOtherModals(e){document.querySelectorAll("p-modal[open]").forEach(t=>{t!==e&&t.close()})}updateConfig(e,t){const a=this.getState(e);a?.modalElement&&(Object.assign(a,t),this._configureModal(a.modalElement,t),this.logger?.info("Modal configuration updated",{triggerElement:e,newConfig:t}))}static enhanceAll(e="[data-modal][data-modal-target]",t){const a=new o(t);return document.querySelectorAll(e).forEach(e=>{a.mount(e)}),a}static async create({title:e,content:o,actions:l=[],size:d="medium",options:i={}}){const n=document.createElement("p-modal");if(n.id=t("modal"),n.setAttribute("data-modal-size",d),Object.entries(i).forEach(([e,t])=>{n.setAttribute(`data-modal-${e}`,String(t))}),e){const t=a("h2",{slot:"title"},e);n.appendChild(t)}if(o){const e=document.createElement("div");e.innerHTML=o,n.appendChild(e)}if(l.length>0){const e=document.createElement("div");e.slot="actions",l.forEach(t=>{const o=a("button",{className:`btn btn--${t.type||"secondary"}`,"data-modal-close":!1!==t.close?"":void 0},t.label);t.onClick&&o.addEventListener("click",t.onClick),e.appendChild(o)}),n.appendChild(e)}document.body.appendChild(n)}}export{o as default};
