import{B as t}from"./index.esm-BW_QP_AR.js";class e extends t{static get defaults(){return{defaultDuration:4e3,defaultType:"info",fadeOutDuration:300,typeMapping:{info:"info",success:"success",warn:"warning",warning:"warning",error:"error",danger:"error"}}}_init(t){const a=super._init(t),s=this._getDataAttr(t,"toast-message"),r=this._getDataAttr(t,"toast-trigger",e.defaults.defaultType),i=parseInt(this._getDataAttr(t,"toast-duration",e.defaults.defaultDuration)),o=this._getDataAttr(t,"toast-title"),n="false"!==this._getDataAttr(t,"toast-dismissible","true");if(!t.hasAttribute("data-toast-trigger"))return this.logger?.warn("Toast component mounted on element without data-toast-trigger attribute",t),a;if(!s)return this.logger?.warn("Toast trigger missing data-toast-message attribute",t),a;a.message=s,a.type=r,a.duration=i,a.title=o,a.dismissible=n;const l=e=>this._handleClick(e,t);t.addEventListener("click",l),t.setAttribute("data-toast-enhanced","true"),t.classList.add("toast-trigger--enhanced");const g=a.cleanup;return a.cleanup=()=>{t.removeEventListener("click",l),t.removeAttribute("data-toast-enhanced"),t.classList.remove("toast-trigger--enhanced"),g()},this.eventBus?.emit("toast:mount",{element:t,message:s,type:r,timestamp:performance.now()}),this.logger?.debug("Toast trigger initialized",{element:t,message:s,type:r,duration:i}),a}_handleClick(t,a){t.preventDefault();const s=this.getState(a);if(!s)return void this.logger?.warn("Toast trigger clicked but no state found",a);const r=e.defaults.typeMapping[s.type]||s.type;this._showToast({message:s.message,type:r,duration:s.duration,title:s.title,dismissible:s.dismissible,trigger:a})}_showToast(t){const{message:a,type:s=e.defaults.defaultType,duration:r=e.defaults.defaultDuration,title:i,dismissible:o=!0,trigger:n}=t;try{if(window.alertManager&&"function"==typeof window.alertManager.show)window.alertManager.show({message:a,type:s,duration:r,title:i,dismissible:o});else{const t=document.querySelector("p-toasts");t&&"function"==typeof t.toast?t.toast({message:a,type:s,duration:r,title:i,dismissible:o}):(this.logger?.warn("No toast system available, falling back to alert"),alert(`${s.toUpperCase()}: ${i?i+"\n":""}${a}`))}this._dispatch(n,"toast:shown",{message:a,type:s,duration:r,title:i}),this.eventBus?.emit("toast:show",{message:a,type:s,duration:r,title:i,trigger:n,timestamp:performance.now()}),this.logger?.info("Toast shown",{message:a,type:s,duration:r,title:i})}catch(e){this.logger?.error("Failed to show toast",e),this._dispatch(n,"toast:error",{error:e.message,message:a,type:s}),this.eventBus?.emit("toast:error",{error:e.message,options:t,trigger:n,timestamp:performance.now()}),alert(`${s.toUpperCase()}: ${i?i+"\n":""}${a}`)}}static show(t,a="info",s={}){(new e)._showToast({message:t,type:a,...s})}getStatus(){return{mountedTriggers:document.querySelectorAll('[data-toast-enhanced="true"]').length,availableTypes:Object.keys(e.defaults.typeMapping),alertManagerAvailable:!(!window.alertManager||"function"!=typeof window.alertManager.show),xToastsAvailable:!!document.querySelector("p-toasts"),defaults:e.defaults}}static enhanceAll(t="[data-toast-trigger][data-toast-message]",a){const s=new e(a);return document.querySelectorAll(t).forEach(t=>{s.mount(t)}),s}}export{e as default};
