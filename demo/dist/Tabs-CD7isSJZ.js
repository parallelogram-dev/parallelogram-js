import{B as t}from"./index.esm-BW_QP_AR.js";import{a as e}from"./parallelogram-demo.min.js";class a extends t{static get defaults(){return{activeClass:"tab--active",panelActiveClass:"tab-panel--active",defaultTab:null,keyboardNavigation:!0,autoFocus:!1,transitionDuration:200,transitionClass:"tab-panel--transitioning"}}_init(t){const e=super._init(t),s=t.querySelector("[data-tabs-list]"),n=t.querySelector("[data-tabs-panels]");if(!s||!n)return this.logger?.warn("Tabs: Missing required elements (data-tabs-list or data-tabs-panels)",t),e;const i=[...s.querySelectorAll("[data-tab]")],l=[...n.querySelectorAll("[data-tab-panel]")];if(0===i.length||0===l.length)return this.logger?.warn("Tabs: No tabs or panels found",t),e;const r=this._getDataAttr(t,"tabs-default-tab",a.defaults.defaultTab),o=this._getDataAttr(t,"tabs-keyboard",a.defaults.keyboardNavigation),c=this._getDataAttr(t,"tabs-autofocus",a.defaults.autoFocus);e.tabsList=s,e.tabsContainer=n,e.tabs=i,e.panels=l,e.activeTab=null,e.activePanel=null,e.keyboardNavigation=o,e.autoFocus=c,this._setupTabs(t,e);const d=this._getInitialTab(i,r);d&&this._activateTab(t,d.dataset.tab,e,!1),this._setupEventListeners(t,e),t.setAttribute("data-tabs-enhanced","true"),t.classList.add("tabs--enhanced");const b=e.cleanup;return e.cleanup=()=>{this._removeEventListeners(t,e),t.removeAttribute("data-tabs-enhanced"),t.classList.remove("tabs--enhanced"),b()},this.eventBus?.emit("tabs:mount",{element:t,tabCount:i.length,panelCount:l.length,timestamp:performance.now()}),this.logger?.info("Tabs initialized",{element:t,tabCount:i.length,panelCount:l.length}),e}_setupTabs(t,a){a.tabs.forEach((t,s)=>{t.setAttribute("role","tab"),t.setAttribute("tabindex","-1"),t.id||(t.id=e("tab"));const n=t.dataset.tab,i=a.panels.find(t=>t.id===n);i&&(i.setAttribute("role","tabpanel"),i.setAttribute("aria-labelledby",t.id),i.setAttribute("tabindex","0"))}),a.tabsList.setAttribute("role","tablist")}_getInitialTab(t,e){const a=t.find(t=>"true"===t.getAttribute("aria-selected"));if(a)return a;if(e){const a=t.find(t=>t.dataset.tab===e);if(a)return a}return t[0]}_setupEventListeners(t,e){e.clickHandlers=new Map,e.keydownHandlers=new Map,e.tabs.forEach(a=>{const s=a=>this._handleTabClick(a,t,e),n=a=>this._handleKeyDown(a,t,e);a.addEventListener("click",s),e.keyboardNavigation&&a.addEventListener("keydown",n),e.clickHandlers.set(a,s),e.keydownHandlers.set(a,n)})}_removeEventListeners(t,e){e.clickHandlers&&e.clickHandlers.forEach((t,e)=>{e.removeEventListener("click",t)}),e.keydownHandlers&&e.keydownHandlers.forEach((t,e)=>{e.removeEventListener("keydown",t)})}_handleTabClick(t,e,a){t.preventDefault();const s=t.currentTarget.dataset.tab;s&&s!==a.activeTab&&this._activateTab(e,s,a,!0)}_handleKeyDown(t,e,a){const s=a.tabs.findIndex(e=>e===t.currentTarget);let n=-1;switch(t.key){case"ArrowRight":case"ArrowDown":t.preventDefault(),n=(s+1)%a.tabs.length;break;case"ArrowLeft":case"ArrowUp":t.preventDefault(),n=(s-1+a.tabs.length)%a.tabs.length;break;case"Home":t.preventDefault(),n=0;break;case"End":t.preventDefault(),n=a.tabs.length-1;break;case"Enter":case" ":t.preventDefault();const i=t.currentTarget.dataset.tab;return void this._activateTab(e,i,a,!0)}if(n>=0){const t=a.tabs[n];a.autoFocus&&t.focus(),this._activateTab(e,t.dataset.tab,a,!0)}}async _activateTab(t,e,s,n=!0){const i=s.tabs.find(t=>t.dataset.tab===e),l=s.panels.find(t=>t.id===e);if(!i||!l)return void this.logger?.warn("Tabs: Invalid tab or panel ID",{panelId:e,element:t});const r=s.activeTab,o=s.activePanel;s.tabs.forEach(t=>{const s=t.dataset.tab===e;t.setAttribute("aria-selected",s?"true":"false"),t.setAttribute("tabindex",s?"0":"-1"),t.classList.toggle(a.defaults.activeClass,s)}),n&&o&&o!==l?await this._transitionPanels(o,l,s):s.panels.forEach(t=>{const s=t.id===e;t.style.display=s?"":"none",t.classList.toggle(a.defaults.panelActiveClass,s)}),s.activeTab=e,s.activePanel=l,s.autoFocus&&i.focus(),this._dispatch(t,"tabs:change",{activeTab:e,previousTab:r,tab:i,panel:l}),this.eventBus?.emit("tabs:change",{element:t,activeTab:e,previousTab:r,tab:i,panel:l,timestamp:performance.now()}),this.logger?.debug("Tab activated",{panelId:e,previousTab:r})}async _transitionPanels(t,e,s){const n=a.defaults.transitionDuration;t.classList.add(a.defaults.transitionClass),e.classList.add(a.defaults.transitionClass),e.style.display="",e.classList.add(a.defaults.panelActiveClass),t.style.opacity="0",await new Promise(t=>setTimeout(t,n/2)),t.style.display="none",t.classList.remove(a.defaults.panelActiveClass),t.style.opacity="",e.style.opacity="0",requestAnimationFrame(()=>{e.style.transition=`opacity ${n}ms ease-in-out`,e.style.opacity="1"}),setTimeout(()=>{e.style.transition="",e.style.opacity="",t.classList.remove(a.defaults.transitionClass),e.classList.remove(a.defaults.transitionClass)},n)}activateTab(t,e){const a=this.getState(t);a&&this._activateTab(t,e,a,!0)}getActiveTab(t){const e=this.getState(t);return e?e.activeTab:null}getStatus(){const t=document.querySelectorAll('[data-tabs-enhanced="true"]');let e=0,s=0;return t.forEach(t=>{const a=this.getState(t);a&&(e+=a.tabs.length,s+=a.panels.length)}),{containers:t.length,totalTabs:e,totalPanels:s,keyboardNavigationSupported:!0,defaults:a.defaults}}static enhanceAll(t="[data-tabs]",e){const s=new a(e);return document.querySelectorAll(t).forEach(t=>{s.mount(t)}),s}}export{a as default};
