import{B as e}from"./index.esm-BW_QP_AR.js";class t extends e{static get defaults(){return{successMessage:"Copied!",errorMessage:"Copy failed",successDuration:2e3,successClass:"copy-success",errorClass:"copy-error"}}_init(e){const t=super._init(e),s=this._getConfiguration(e),o=this._getTarget(e);return t.config=s,t.target=o,t.originalText=e.textContent,e.addEventListener("click",s=>{s.preventDefault(),this._handleCopy(e,t)}),this.eventBus?.emit("copy-to-clipboard:mounted",{element:e,target:o}),t}_getConfiguration(e){return{successMessage:this._getDataAttr(e,"copy-success-message",t.defaults.successMessage),errorMessage:this._getDataAttr(e,"copy-error-message",t.defaults.errorMessage),successDuration:parseInt(this._getDataAttr(e,"copy-success-duration",t.defaults.successDuration)),successClass:this._getDataAttr(e,"copy-success-class",t.defaults.successClass),errorClass:this._getDataAttr(e,"copy-error-class",t.defaults.errorClass)}}_getTarget(e){const t=e.dataset.copyTarget,s=e.dataset.copyText;if(s)return{type:"text",content:s};if(t){const e=document.querySelector(t);if(e)return{type:"element",element:e}}return{type:"text",content:e.textContent}}async _handleCopy(e,t){try{let s="";if("text"===t.target.type?s=t.target.content:"element"===t.target.type&&(s=t.target.element.value||t.target.element.textContent),!s)throw new Error("No text to copy");navigator.clipboard&&window.isSecureContext?await navigator.clipboard.writeText(s):this._fallbackCopy(s),this._showSuccess(e,t),this.eventBus?.emit("copy-to-clipboard:success",{element:e,text:s})}catch(s){this._showError(e,t),this.eventBus?.emit("copy-to-clipboard:error",{element:e,error:s.message})}}_fallbackCopy(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}finally{document.body.removeChild(t)}}_showSuccess(e,t){e.textContent=t.config.successMessage,e.classList.add(t.config.successClass),e.disabled=!0,setTimeout(()=>{e.textContent=t.originalText,e.classList.remove(t.config.successClass),e.disabled=!1},t.config.successDuration)}_showError(e,t){e.textContent=t.config.errorMessage,e.classList.add(t.config.errorClass),setTimeout(()=>{e.textContent=t.originalText,e.classList.remove(t.config.errorClass)},t.config.successDuration)}static enhanceAll(e="[data-copy-to-clipboard]",s){const o=new t(s);return document.querySelectorAll(e).forEach(e=>o.mount(e)),o}}export{t as CopyToClipboard,t as default};
