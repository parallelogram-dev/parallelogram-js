// datatable.scss
// DataTable Component Styles using BEM methodology with CSS Custom Properties

// CSS Custom Properties (CSS Variables) with fallbacks
.datatable {
  // Core colors
  --datatable-border-color: #dee2e6;
  --datatable-bg-color: #fff;
  --datatable-header-bg: #f8f9fa;
  --datatable-hover-bg: #e9ecef;
  --datatable-primary-color: #007bff;
  --datatable-text-color: #495057;
  --datatable-muted-color: #6c757d;
  --datatable-error-color: #dc3545;

  // Spacing
  --datatable-spacing-xs: 0.25rem;
  --datatable-spacing-sm: 0.5rem;
  --datatable-spacing-md: 0.75rem;
  --datatable-spacing-lg: 1rem;

  // Visual properties
  --datatable-border-radius: 4px;
  --datatable-disabled-opacity: 0.5;
  --datatable-transition: all 0.2s ease;
  --datatable-font-size: 1rem;
  --datatable-font-size-sm: 0.875rem;
  --datatable-font-size-xs: 0.75rem;
  --datatable-font-weight-normal: 400;
  --datatable-font-weight-bold: 600;

  // Z-index
  --datatable-z-index-loading: 1;

  // Shadow and effects
  --datatable-box-shadow-focus: 0 0 0 2px rgba(0, 123, 255, 0.25);
  --datatable-row-hover-bg: rgba(0, 123, 255, 0.05);

  // Dark mode overrides (can be set programmatically)
  @media (prefers-color-scheme: dark) {
    --datatable-bg-color: #343a40;
    --datatable-header-bg: #495057;
    --datatable-border-color: #495057;
    --datatable-text-color: #fff;
    --datatable-hover-bg: #5a6268;
    --datatable-muted-color: #adb5bd;
  }
}

// Mixins using CSS variables
@mixin datatable-button {
  padding: var(--datatable-spacing-sm) var(--datatable-spacing-md);
  border: 1px solid var(--datatable-border-color);
  background-color: var(--datatable-bg-color);
  color: var(--datatable-text-color);
  cursor: pointer;
  border-radius: var(--datatable-border-radius);
  font-size: var(--datatable-font-size-sm);
  transition: var(--datatable-transition);

  &:hover:not(:disabled) {
    background-color: var(--datatable-hover-bg);
    border-color: var(--datatable-border-color);
    filter: brightness(0.95);
  }

  &:disabled {
    opacity: var(--datatable-disabled-opacity);
    cursor: not-allowed;
  }
}

@mixin datatable-focus {
  outline: none;
  border-color: var(--datatable-primary-color);
  box-shadow: var(--datatable-box-shadow-focus);
}

// Main DataTable Block
.datatable {
  // Filter Element
  &__filter {
    margin-bottom: var(--datatable-spacing-lg);
  }

  // Search Input
  &__search {
    padding: var(--datatable-spacing-sm);
    border: 1px solid var(--datatable-border-color);
    border-radius: var(--datatable-border-radius);
    font-size: var(--datatable-font-size);
    width: 100%;
    max-width: 300px;
    background-color: var(--datatable-bg-color);
    color: var(--datatable-text-color);

    &:focus {
      @include datatable-focus;
    }

    &--invalid {
      border-color: var(--datatable-error-color);
    }

    &::placeholder {
      color: var(--datatable-muted-color);
    }
  }

  // Table Element
  &__table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--datatable-spacing-lg);
    background-color: var(--datatable-bg-color);
    color: var(--datatable-text-color);

    // Table Header
    &-header {
      background-color: var(--datatable-header-bg);
      font-weight: var(--datatable-font-weight-bold);
      border-bottom: 2px solid var(--datatable-border-color);
    }

    // Table Cell (both th and td)
    &-cell {
      padding: var(--datatable-spacing-md);
      text-align: left;
      border-bottom: 1px solid var(--datatable-border-color);

      // Sortable Header Modifier
      &--sortable {
        cursor: pointer;
        user-select: none;
        position: relative;
        transition: background-color 0.2s ease;

        &:hover {
          background-color: var(--datatable-hover-bg);
        }
      }
    }

    // Table Body
    &-body {
      // Row Hover State
      .datatable__table-row:hover {
        background-color: var(--datatable-row-hover-bg);
      }
    }
  }

  // Sort Icon
  &__sort-icon {
    margin-left: var(--datatable-spacing-sm);
    font-size: var(--datatable-font-size-sm);
    color: var(--datatable-muted-color);
    font-weight: var(--datatable-font-weight-normal);
  }

  // Pagination Block
  &__pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--datatable-spacing-xs);
    margin-top: var(--datatable-spacing-lg);

    // Pagination Button
    &-button {
      @include datatable-button;

      &--active {
        background-color: var(--datatable-primary-color);
        color: white;
        border-color: var(--datatable-primary-color);
      }
    }
  }

  // Loading State Modifier
  &--loading {
    position: relative;
    opacity: var(--datatable-disabled-opacity);
    pointer-events: none;

    &::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid var(--datatable-border-color);
      border-top: 2px solid var(--datatable-primary-color);
      border-radius: 50%;
      animation: datatable-spin 1s linear infinite;
      z-index: var(--datatable-z-index-loading);
    }
  }
}

// Animations
@keyframes datatable-spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

// Responsive Design
@media (max-width: 768px) {
  .datatable {
    --datatable-font-size: 0.875rem;
    --datatable-spacing-md: 0.5rem;

    &__search {
      max-width: 100%;
    }

    &__pagination {
      flex-wrap: wrap;
    }
  }
}

// Theme variants using CSS custom properties
.datatable {
  // Light theme variant
  &--theme-light {
    --datatable-bg-color: #ffffff;
    --datatable-header-bg: #f8f9fa;
    --datatable-text-color: #212529;
    --datatable-border-color: #dee2e6;
    --datatable-hover-bg: #e9ecef;
  }

  // Dark theme variant
  &--theme-dark {
    --datatable-bg-color: #343a40;
    --datatable-header-bg: #495057;
    --datatable-text-color: #ffffff;
    --datatable-border-color: #495057;
    --datatable-hover-bg: #5a6268;
    --datatable-muted-color: #adb5bd;
  }

  // Compact size variant
  &--size-compact {
    --datatable-spacing-md: 0.5rem;
    --datatable-spacing-sm: 0.25rem;
    --datatable-font-size: 0.875rem;
  }

  // Large size variant
  &--size-large {
    --datatable-spacing-md: 1rem;
    --datatable-spacing-sm: 0.75rem;
    --datatable-font-size: 1.125rem;
  }
}

// Usage with data attributes (maintains progressive enhancement)
table[data-datatable] {
  @extend .datatable__table;

  th {
    @extend .datatable__table-cell;
    @extend .datatable__table-header;

    &.sortable {
      @extend .datatable__table-cell--sortable;
    }
  }

  td {
    @extend .datatable__table-cell;
  }

  tbody {
    @extend .datatable__table-body;
  }

  tr {
    @extend .datatable__table-row;
  }
}

.datatable-filter {
  @extend .datatable__filter;
}

.datatable-search {
  @extend .datatable__search;
}

.datatable-pagination {
  @extend .datatable__pagination;

  button {
    @extend .datatable__pagination-button;

    &.active {
      @extend .datatable__pagination-button--active;
    }
  }
}

.sort-icon {
  @extend .datatable__sort-icon;
}

.datatable-loading {
  @extend .datatable--loading;
}