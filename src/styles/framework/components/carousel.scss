/**
 * Carousel Component Styles
 * BEM methodology: .carousel__element--modifier
 * Progressive enhancement via data-carousel attributes
 */

// Carousel component variables
:root {
  // Dimensions
  --carousel-height: 400px;
  --carousel-aspect-ratio: 16 / 9;

  // Timing
  --carousel-transition-duration: var(--transition-slow, 0.3s);
  --carousel-transition-easing: var(--ease-in-out, ease-in-out);
  --carousel-autoplay-delay: 5000ms;

  // Colors
  --carousel-arrow-bg: rgba(0, 0, 0, 0.7);
  --carousel-arrow-color: var(--color-white, white);
  --carousel-arrow-hover-bg: rgba(0, 0, 0, 0.9);
  --carousel-dot-bg: rgba(255, 255, 255, 0.5);
  --carousel-dot-active-bg: var(--color-white, white);
  --carousel-dot-size: 12px;
  --carousel-bg: var(--color-gray-100, #f5f5f5);

  // Shadows
  --carousel-shadow: var(--shadow-lg, 0 4px 20px rgba(0, 0, 0, 0.1));
  --carousel-arrow-shadow: var(--shadow, 0 2px 8px rgba(0, 0, 0, 0.2));
  
  // Spacing
  --carousel-padding: var(--spacing-4, 1rem);
  --carousel-arrow-spacing: var(--spacing-4, 1rem);
  --carousel-dot-spacing: var(--spacing-2, 0.5rem);
  
  // Z-index
  --carousel-z-index: var(--z-index-dropdown, 1000);
  
  // Sizes
  --carousel-arrow-size: 48px;
  --carousel-control-size: 40px;
}

// Dark mode adjustments
@media (prefers-color-scheme: dark) {
  :root {
    --carousel-arrow-bg: rgba(255, 255, 255, 0.2);
    --carousel-arrow-hover-bg: rgba(255, 255, 255, 0.3);
    --carousel-dot-bg: rgba(255, 255, 255, 0.3);
    --carousel-bg: var(--color-gray-800, #343a40);
  }
}

// Block: Carousel container
.carousel {
  position: relative;
  width: 100%;
  height: var(--carousel-height);
  overflow: hidden;
  border-radius: var(--border-radius-md, 8px);
  box-shadow: var(--carousel-shadow);
  background: var(--carousel-bg);

  // Modifiers
  &--fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    border-radius: 0;
    z-index: var(--z-index-modal, 1050);
  }

  &--aspect-ratio {
    height: auto;
    aspect-ratio: var(--carousel-aspect-ratio);
  }

  &--loading {
    background: linear-gradient(90deg, 
      var(--color-gray-200, #f0f0f0) 25%, 
      var(--color-gray-300, #e0e0e0) 50%, 
      var(--color-gray-200, #f0f0f0) 75%
    );
    background-size: 200% 100%;
    animation: carousel-loading 1.5s infinite;
  }

  // Element: Track (slide container)
  &__track {
    display: flex;
    width: 100%;
    height: 100%;
    transition: transform var(--carousel-transition-duration) var(--carousel-transition-easing);
    will-change: transform;
  }

  // Element: Individual slides
  &__slide {
    flex: 0 0 100%;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;

    &--active {
      z-index: 1;
    }

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
  }

  // Element: Navigation arrows
  &__arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: var(--carousel-arrow-size);
    height: var(--carousel-arrow-size);
    border: none;
    border-radius: 50%;
    background: var(--carousel-arrow-bg);
    color: var(--carousel-arrow-color);
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    z-index: 2;
    transition: all var(--transition-fast, 0.15s) ease;
    box-shadow: var(--carousel-arrow-shadow);
    display: flex;
    align-items: center;
    justify-content: center;

    &:hover:not(:disabled) {
      background: var(--carousel-arrow-hover-bg);
      transform: translateY(-50%) scale(1.1);
    }

    &:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    &:focus-visible {
      outline: var(--framework-focus-width, 2px) solid var(--framework-focus-color, #3b82f6);
      outline-offset: var(--framework-focus-offset, 2px);
    }

    // Modifiers
    &--prev {
      left: var(--carousel-arrow-spacing);
      
      &::before {
        content: '‹';
        font-size: 1.5em;
        margin-right: 2px;
      }
    }

    &--next {
      right: var(--carousel-arrow-spacing);
      
      &::before {
        content: '›';
        font-size: 1.5em;
        margin-left: 2px;
      }
    }

    &--large {
      width: 64px;
      height: 64px;
      font-size: 24px;
    }
  }

  // Element: Dot indicators container
  &__dots {
    position: absolute;
    bottom: var(--carousel-arrow-spacing);
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: var(--carousel-dot-spacing);
    z-index: 2;
  }

  // Element: Individual dot
  &__dot {
    width: var(--carousel-dot-size);
    height: var(--carousel-dot-size);
    border: none;
    border-radius: 50%;
    background: var(--carousel-dot-bg);
    cursor: pointer;
    transition: all var(--transition-fast, 0.15s) ease;
    padding: 0;

    &:hover,
    &--active {
      background: var(--carousel-dot-active-bg);
      transform: scale(1.2);
    }

    &:focus-visible {
      outline: var(--framework-focus-width, 2px) solid var(--carousel-dot-active-bg);
      outline-offset: var(--framework-focus-offset, 2px);
    }

    // Modifiers
    &--large {
      width: 16px;
      height: 16px;
    }

    &--square {
      border-radius: var(--border-radius-sm, 2px);
    }
  }

  // Element: Caption overlay
  &__caption {
    position: absolute;
    bottom: calc(var(--carousel-arrow-spacing) * 3);
    left: var(--carousel-arrow-spacing);
    right: var(--carousel-arrow-spacing);
    background: rgba(0, 0, 0, 0.7);
    color: var(--color-white, white);
    padding: var(--spacing-4, 1rem);
    border-radius: var(--border-radius, 4px);
    z-index: 2;
    backdrop-filter: blur(4px);

    &--top {
      top: var(--carousel-arrow-spacing);
      bottom: auto;
    }
  }

  // Element: Play/pause control
  &__control {
    position: absolute;
    top: var(--carousel-arrow-spacing);
    right: var(--carousel-arrow-spacing);
    width: var(--carousel-control-size);
    height: var(--carousel-control-size);
    border: none;
    border-radius: 50%;
    background: var(--carousel-arrow-bg);
    color: var(--carousel-arrow-color);
    cursor: pointer;
    z-index: 2;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-fast, 0.15s) ease;

    &:hover {
      background: var(--carousel-arrow-hover-bg);
    }

    &:focus-visible {
      outline: var(--framework-focus-width, 2px) solid var(--framework-focus-color, #3b82f6);
      outline-offset: var(--framework-focus-offset, 2px);
    }

    &--playing::before {
      content: '⏸';
    }

    &--paused::before {
      content: '▶';
    }
  }

  // Element: Progress bar
  &__progress {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: rgba(255, 255, 255, 0.2);
    z-index: 2;

    &-bar {
      height: 100%;
      background: var(--carousel-dot-active-bg);
      width: 0%;
      transition: width var(--carousel-transition-duration) linear;
    }
  }
}

// Loading animation
@keyframes carousel-loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

// Responsive adjustments
@media (max-width: 768px) {
  :root {
    --carousel-arrow-size: 40px;
    --carousel-control-size: 36px;
    --carousel-arrow-spacing: var(--spacing-2, 0.5rem);
    --carousel-dot-size: 10px;
  }

  .carousel {
    &__caption {
      padding: var(--spacing-3, 0.75rem);
      font-size: var(--font-size-sm, 0.875rem);
    }
  }
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
  .carousel {
    &__track {
      transition: none;
    }

    &__arrow {
      transition: none;
      
      &:hover:not(:disabled) {
        transform: translateY(-50%);
      }
    }

    &__dot {
      transition: none;
      
      &:hover,
      &--active {
        transform: none;
      }
    }

    &--loading {
      animation: none;
      background: var(--carousel-bg);
    }
  }
}

// High contrast mode
@media (prefers-contrast: more) {
  .carousel {
    &__arrow {
      border: 2px solid currentColor;
    }

    &__dot {
      border: 2px solid var(--color-white, white);
      
      &--active {
        border-color: var(--carousel-dot-active-bg);
      }
    }
  }
}

// Focus management for keyboard navigation
[data-carousel]:focus-within {
  outline: var(--framework-focus-width, 2px) solid var(--framework-focus-color, #3b82f6);
  outline-offset: var(--framework-focus-offset, 2px);
}