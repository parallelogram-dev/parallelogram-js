class PDatetime extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this._view=new Date,this._step=15,this._weekStart=1,this._viewMode="day",this._animating=!1,this._navigationDirection=null,this._touchStartX=0,this._touchEndX=0,this._modeConfig={date:{showCalendar:!0,showTime:!1,showQuickDates:!0,formatOpts:{dateStyle:"medium"},placeholders:{single:"Select date...",rangeFrom:"Start date...",rangeTo:"End date..."}},datetime:{showCalendar:!0,showTime:!0,showQuickDates:!0,formatOpts:{dateStyle:"medium",timeStyle:"short"},placeholders:{single:"Select date & time...",rangeFrom:"Start date & time...",rangeTo:"End date & time..."}},time:{showCalendar:!1,showTime:!0,showQuickDates:!1,formatOpts:{timeStyle:"short"},placeholders:{single:"Select time...",rangeFrom:"Start time...",rangeTo:"End time..."}}},this.shadowRoot.innerHTML='\n          <style>[hidden]{display:none!important}:host{--datetime-text:currentColor;--datetime-muted:rgba(0,0,0,.5);--datetime-accent:#3b82f6;--datetime-hover:rgba(0,0,0,.05);--datetime-bg:#fff;--datetime-border:rgba(0,0,0,.1);--datetime-shadow-color:rgba(0,0,0,.12);--datetime-focus-shadow:rgba(59,130,246,.1);--datetime-btn-hover-bg:rgba(0,0,0,.08);--datetime-placeholder-opacity:0.6;--datetime-icon-opacity:0.7;--datetime-disabled-opacity:0.3;--datetime-padding-x:0.75em;--datetime-padding-y:0.375em;--datetime-space-xs:0.125em;--datetime-space-sm:0.25em;--datetime-space-md:0.5em;--datetime-space-lg:0.75em;--datetime-gap:0.5em;--datetime-radius:0.5em;--datetime-radius-lg:0.75em;--datetime-radius-xl:1em;--datetime-border-width:1px;--datetime-focus-ring-width:2px;--datetime-today-border-width:2px;--datetime-shadow:0 0.625em 1.875em var(--datetime-shadow-color);--datetime-transition:0.15s ease;--datetime-animation-duration:0.5s;--datetime-cell-size:2.5em;--datetime-font-sm:0.75em;--datetime-font-md:0.875em;box-sizing:border-box;display:inline-block;position:relative}@media (prefers-color-scheme:dark){:host{--datetime-muted:hsla(0,0%,100%,.5);--datetime-hover:hsla(0,0%,100%,.1)}}.ampm,.btn,.panel,.preset,.time-select{border:var(--datetime-border-width) solid var(--datetime-border)}.actions,.grid-container,.quick-dates,.time{border-top:var(--datetime-border-width) solid var(--datetime-border)}.ampm,.btn,.day,.month,.month-year,.nav button,.time-select,.year{border-radius:var(--datetime-radius)}.btn,.calendar-btn,.day,.month,.month-year,.nav button,.time,.year{align-items:center;display:flex;justify-content:center}@media (prefers-reduced-motion:no-preference){.ampm,.btn,.day,.month,.nav button,.panel,.time-select,.year{transition:all var(--datetime-transition)}}.ampm,.btn,.day,.month,.month-year,.time-select,.year{font-size:var(--datetime-font-md)}.preset,.range-info{font-size:.8em}@media (hover:hover){.calendar-btn:hover,.month-year:hover,.nav button:hover{background:var(--datetime-hover);color:var(--datetime-accent)}.day:hover,.month:hover,.year:hover{background:var(--datetime-hover)}.ampm:hover,.time-select:hover{background-color:var(--datetime-hover);border-color:var(--datetime-accent)}.preset:hover{background:var(--datetime-accent);color:var(--datetime-bg)}.btn:hover,.preset:hover{border-color:var(--datetime-accent)}.btn:hover{background:var(--datetime-btn-hover-bg)}.btn.primary:hover{opacity:.9}}.field{align-items:stretch;bottom:0;box-sizing:border-box;font:inherit;left:0;position:absolute;right:0;top:0}.field,.input{border-radius:inherit;display:flex;overflow:hidden}.input{align-items:center;color:var(--datetime-text);flex:1;min-width:0;padding:var(--datetime-padding-y) var(--datetime-padding-x);text-overflow:ellipsis;transition:box-shadow var(--datetime-transition);white-space:nowrap}.input:first-of-type:not(:only-of-type){border-bottom-right-radius:0;border-top-right-radius:0}.input:nth-of-type(2){border-bottom-left-radius:0;border-left:var(--datetime-border-width) solid var(--datetime-border);border-top-left-radius:0}.input.is-focused{box-shadow:inset 0 0 0 var(--datetime-focus-ring-width) var(--datetime-accent)}.input[data-placeholder]:empty:before{color:var(--datetime-muted);content:attr(data-placeholder);opacity:var(--datetime-placeholder-opacity)}.btn,.calendar-btn,.day,.month,.month-year,.nav button,.preset,.year{background:none;border:none;color:inherit;cursor:pointer}.calendar-btn{opacity:var(--datetime-icon-opacity);padding:0 var(--datetime-padding-x)}.panel{background:var(--datetime-bg);border-radius:var(--datetime-radius-lg);box-shadow:var(--datetime-shadow);left:0;margin-top:var(--datetime-gap);min-width:20em;opacity:0;padding:var(--datetime-space-lg);pointer-events:none;position:absolute;top:100%;transform:translateY(-.5em);z-index:9}.panel.open{opacity:1;pointer-events:all;transform:translateY(0)}.nav{align-items:center;display:flex;justify-content:space-between;margin:0;padding-bottom:var(--datetime-space-lg)}.nav button{color:var(--datetime-muted);padding:var(--datetime-gap)}.month-year{color:var(--datetime-text);font-weight:600;gap:var(--datetime-space-sm);padding:var(--datetime-space-sm) var(--datetime-gap);transition:background-color var(--datetime-transition)}.month-year:active{background:var(--datetime-hover);opacity:.8}.month-year svg{margin-left:var(--datetime-space-xs);opacity:var(--datetime-placeholder-opacity)}.grid-container{height:18.75em;overflow:hidden;padding-top:var(--datetime-space-lg);position:relative}.grid{align-content:start;display:grid;gap:var(--datetime-space-xs);grid-template-columns:repeat(7,1fr);grid-template-rows:2em repeat(6,var(--datetime-cell-size));height:18em;justify-items:center}.grid.month-view,.grid.year-view{gap:var(--datetime-gap);grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(4,1fr)}.grid--animating{left:0;position:absolute;right:0;top:var(--datetime-space-lg)}.grid.animating{transition:transform var(--datetime-animation-duration) cubic-bezier(.5,0,0,1)}.grid--prev.grid--out{transform:translateX(100%)}.grid--next.grid--out,.grid--prev.grid--in{transform:translateX(-100%)}.grid--next.grid--in{transform:translateX(100%)}.grid:not(.grid--in):not(.grid--out){transform:translateX(0)}@media (prefers-reduced-motion:reduce){.grid{transform:none!important;transition:opacity var(--datetime-transition)}}.wd{font-size:var(--datetime-font-sm);font-weight:600;opacity:var(--datetime-placeholder-opacity);padding:var(--datetime-gap) 0;text-transform:uppercase}.day,.month,.year{height:var(--datetime-cell-size);width:100%}.day.today,.month.today,.year.today{border:var(--datetime-today-border-width) solid var(--datetime-accent);position:relative}.day.in-range{background:var(--datetime-accent);color:var(--datetime-bg);opacity:.6}.day.range-end,.day.range-start,.day.selected,.month.selected,.year.selected{background:var(--datetime-accent);color:var(--datetime-bg);opacity:1}.month,.year{height:3em}.day:disabled{cursor:not-allowed;opacity:var(--datetime-disabled-opacity)}.day.range-hover{background:var(--datetime-focus-shadow)}.time{gap:var(--datetime-gap);padding:var(--datetime-space-lg) 0}.time-separator{color:var(--datetime-muted);font-size:1.25em;font-weight:600}.ampm,.time-select{appearance:none;background-color:var(--datetime-bg);background-image:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 9l4 -4l4 4" /><path d="M16 15l-4 4l-4 -4" /></svg>\');background-position:right var(--datetime-gap) center;background-repeat:no-repeat;background-size:1em;color:var(--datetime-text);cursor:pointer;font-weight:500;min-width:4em;padding:var(--datetime-gap) 1.75em var(--datetime-gap) var(--datetime-space-lg)}.ampm:focus,.time-select:focus{border-color:var(--datetime-accent);box-shadow:0 0 0 3px var(--datetime-focus-shadow);outline:none}.quick-dates{display:flex;flex-wrap:wrap;gap:.375em;padding:var(--datetime-space-lg) 0}.preset{border-radius:var(--datetime-radius-xl);color:var(--datetime-muted);padding:.375em var(--datetime-space-lg)}.actions{display:flex;gap:var(--datetime-gap);justify-content:space-between;padding-top:var(--datetime-space-lg)}.btn{background:var(--datetime-hover);color:var(--datetime-text);min-height:var(--datetime-cell-size);padding:.625em 1em}.btn.primary{background:var(--datetime-accent);border-color:var(--datetime-accent);color:var(--datetime-bg)}.range-info{background:var(--datetime-hover);color:var(--datetime-muted);margin-bottom:var(--datetime-space-lg);padding:var(--datetime-gap) var(--datetime-gap);text-align:center}</style>\n\n          <div class="field">\n            <div class="input" data-datetime-input data-placeholder="Select date..."></div>\n            <div class="input" data-datetime-input-to hidden data-placeholder="End date..."></div>\n            <button type="button" class="calendar-btn" data-datetime-trigger><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z" /><path d="M16 3v4" /><path d="M8 3v4" /><path d="M4 11h16" /><path d="M8 14v4" /><path d="M12 14v4" /><path d="M16 14v4" /></svg></button>\n          </div>\n\n          <div class="panel" data-datetime-panel hidden>\n            <div class="range-info" data-datetime-range-info hidden>Click to select start date, then select end date</div>\n\n            <div class="nav" data-datetime-nav>\n              <button data-datetime-nav-btn="prev"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l14 0" /><path d="M5 12l6 6" /><path d="M5 12l6 -6" /></svg></button>\n              <div class="month-year" data-datetime-month-year>\n                <span data-slot="month"></span>\n                <span data-slot="year"></span>\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 9l4 -4l4 4" /><path d="M16 15l-4 4l-4 -4" /></svg>\n              </div>\n              <button data-datetime-nav-btn="next"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l14 0" /><path d="M19 12l-6 6" /><path d="M19 12l-6 -6" /></svg></button>\n            </div>\n\n            <div class="grid-container" data-datetime-grid-container>\n              <div class="grid" data-datetime-grid></div>\n            </div>\n\n            <div class="quick-dates" data-datetime-quick-dates hidden></div>\n\n            <div class="time" data-datetime-time hidden>\n              <select class="time-select" data-datetime-hour></select>\n              <div class="time-separator">:</div>\n              <select class="time-select" data-datetime-minute></select>\n              <select class="ampm" data-datetime-ampm hidden>\n                <option value="AM">AM</option>\n                <option value="PM">PM</option>\n              </select>\n            </div>\n\n            <div class="actions">\n              <button class="btn" data-datetime-action="clear">Clear</button>\n              <button class="btn primary" data-datetime-action="apply">Apply</button>\n            </div>\n          </div>\n        ',this._input=this.shadowRoot.querySelector("[data-datetime-input]"),this._toInput=this.shadowRoot.querySelector("[data-datetime-input-to]"),this._btn=this.shadowRoot.querySelector("[data-datetime-trigger]"),this._panel=this.shadowRoot.querySelector("[data-datetime-panel]"),this._nav=this.shadowRoot.querySelector("[data-datetime-nav]"),this._gridContainer=this.shadowRoot.querySelector("[data-datetime-grid-container]"),this._grid=this.shadowRoot.querySelector("[data-datetime-grid]"),this._month=this.shadowRoot.querySelector('[data-slot="month"]'),this._year=this.shadowRoot.querySelector('[data-slot="year"]'),this._monthYearBtn=this.shadowRoot.querySelector("[data-datetime-month-year]"),this._timeWrap=this.shadowRoot.querySelector("[data-datetime-time]"),this._hourSelect=this.shadowRoot.querySelector("[data-datetime-hour]"),this._minuteSelect=this.shadowRoot.querySelector("[data-datetime-minute]"),this._ampm=this.shadowRoot.querySelector("[data-datetime-ampm]"),this._quickDates=this.shadowRoot.querySelector("[data-datetime-quick-dates]"),this._rangeInfo=this.shadowRoot.querySelector("[data-datetime-range-info]"),this._hidden=null,this._hiddenTo=null,this._currentField="from",this._rangeState=null}connectedCallback(){this._bindEvents(),this._render(),this.name&&this._ensureHidden(),requestAnimationFrame(()=>{this._updateTheme()})}_updateTheme(t=null){const e=t||this.getAttribute("theme");!e||"inherit"===e?this._applyInheritTheme():this._applyNamedTheme(e)}_applyInheritTheme(){this.hasAttribute("theme")||this.setAttribute("theme","inherit");const t=getComputedStyle(this);this.shadowRoot.querySelectorAll("input").forEach(e=>{e.style.setProperty("--datetime-input-color",t.color),e.style.setProperty("--datetime-input-font-size",t.fontSize),e.style.setProperty("--datetime-input-font-family",t.fontFamily)}),this.style.setProperty("--datetime-input-background",t.backgroundColor),this.style.setProperty("--datetime-input-color",t.color),this.style.setProperty("--datetime-input-font-size",t.fontSize),this.style.setProperty("--datetime-input-font-family",t.fontFamily)}_applyNamedTheme(t){"inherit"===this.getAttribute("theme")&&this.removeAttribute("theme"),t&&"inherit"!==t&&this.setAttribute("theme",t)}static get observedAttributes(){return["name","value","mode","time-format","show-quick-dates","quick-dates","range","range-to","from-label","to-label","range-to-value","theme","format"]}attributeChangedCallback(t,e,i){e!==i&&("theme"===t&&this._updateTheme(i),this.isConnected&&this._render())}_bindEvents(){this._btn.addEventListener("click",()=>{this.isRange&&(this._currentField="from",this._rangeState="selecting-from"),this._updateFocusRing(),this.toggle()}),this._input.addEventListener("click",()=>{this.isRange&&(this._currentField="from",this._rangeState="selecting-from"),this._updateFocusRing(),this.open()}),this._toInput.addEventListener("click",()=>{this._currentField="to",this._rangeState="selecting-to",this._updateFocusRing(),this.open()}),this.shadowRoot.querySelectorAll("[data-datetime-nav-btn]").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-datetime-nav-btn");this._handleNavigation(e)})}),this._monthYearBtn.addEventListener("click",()=>{this._handleMonthYearClick()}),this._gridContainer.addEventListener("touchstart",t=>{this._touchStartX=t.changedTouches[0].screenX},{passive:!0}),this._gridContainer.addEventListener("touchend",t=>{this._touchEndX=t.changedTouches[0].screenX,this._handleSwipe()},{passive:!0}),this.shadowRoot.querySelectorAll("[data-datetime-action]").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-datetime-action");"clear"===e?(this.isRange&&"to"===this._currentField?this.rangeToValue="":this.value="",this._emitChange(),this._render()):"apply"===e&&this.close()})}),this._hourSelect.addEventListener("change",()=>this._syncTime()),this._minuteSelect.addEventListener("change",()=>this._syncTime()),this._ampm.addEventListener("change",()=>this._syncTime()),document.addEventListener("click",t=>{this.contains(t.target)||this.close()})}get mode(){return this.getAttribute("mode")||"date"}set mode(t){this.setAttribute("mode",t)}get value(){return this.getAttribute("value")||""}set value(t){t?this.setAttribute("value",t):this.removeAttribute("value")}get name(){return this.getAttribute("name")}set name(t){t?this.setAttribute("name",t):this.removeAttribute("name")}get timeFormat(){return this.getAttribute("time-format")||"24"}set timeFormat(t){this.setAttribute("time-format",t)}get showQuickDates(){return this.hasAttribute("show-quick-dates")}set showQuickDates(t){t?this.setAttribute("show-quick-dates",""):this.removeAttribute("show-quick-dates")}get quickDates(){return this.getAttribute("quick-dates")||"yesterday,today,tomorrow"}set quickDates(t){this.setAttribute("quick-dates",t)}get isRange(){return this.hasAttribute("range")}set isRange(t){t?this.setAttribute("range",""):this.removeAttribute("range")}get rangeTo(){return this.getAttribute("range-to")}set rangeTo(t){t?this.setAttribute("range-to",t):this.removeAttribute("range-to")}get fromLabel(){return this.getAttribute("from-label")||"From"}set fromLabel(t){this.setAttribute("from-label",t)}get toLabel(){return this.getAttribute("to-label")||"To"}set toLabel(t){this.setAttribute("to-label",t)}get rangeToValue(){return this.getAttribute("range-to-value")||""}set rangeToValue(t){t?this.setAttribute("range-to-value",t):this.removeAttribute("range-to-value")}get format(){return this.getAttribute("format")||""}set format(t){t?this.setAttribute("format",t):this.removeAttribute("format")}open(){this._panel.hidden=!1,requestAnimationFrame(()=>{this._panel.classList.add("open")})}close(){this._panel.classList.remove("open"),this._input.classList.remove("is-focused"),this._toInput.classList.remove("is-focused"),setTimeout(()=>{this._panel.hidden=!0},150)}toggle(){this._panel.hidden?this.open():this.close()}_render(){this._renderMode(),this._renderCalendar(),this._renderTime(),this._renderInput(),this._renderQuickDates()}_renderMode(){this.isRange?(this._input.hidden=!1,this._toInput.hidden=!1,this._rangeInfo.hidden=!1,this.value?this.rangeToValue?this._rangeInfo.textContent="Range selected. Click dates to modify.":this._rangeInfo.textContent="Start date selected. Now select end date":this._rangeInfo.textContent="Click to select start date"):(this._input.hidden=!1,this._toInput.hidden=!0,this._rangeInfo.hidden=!0)}_renderCalendar(){const t=this._modeConfig[this.mode];if(this.shadowRoot.querySelector(".nav").hidden=!t.showCalendar,this._gridContainer.hidden=!t.showCalendar,!t.showCalendar)return;const e=this._view.getFullYear(),i=this._view.getMonth();if("year"===this._viewMode){const t=e-5,i=e+6;this._month.textContent=`${t} - ${i}`,this._year.textContent=""}else"month"===this._viewMode?(this._month.textContent=String(e),this._year.textContent=""):(this._month.textContent=new Intl.DateTimeFormat(void 0,{month:"long"}).format(this._view),this._year.textContent=String(e));if(this._navigationDirection&&!this._animating){this._animating=!0;const t=this._grid.cloneNode(!0);t.classList.add("grid--animating",`grid--${this._navigationDirection}`),this._gridContainer.appendChild(t),this._grid.classList.add(`grid--${this._navigationDirection}`,"grid--in"),requestAnimationFrame(()=>{t.classList.add("animating","grid--out"),this._grid.classList.add("animating"),this._grid.classList.remove("grid--in"),setTimeout(()=>{t.remove(),this._grid.classList.remove("animating",`grid--${this._navigationDirection}`),this._animating=!1,this._navigationDirection=null},500)})}if("month"===this._viewMode)return void this._renderMonthPicker();if("year"===this._viewMode)return void this._renderYearPicker();const a=new Date,n=this.value?new Date(this.value):null;this._grid.classList.remove("month-view","year-view");const s=(new Date(e,i,1).getDay()-this._weekStart+7)%7,r=new Date(e,i+1,0).getDate();this._grid.innerHTML="";for(let t=0;t<7;t++){const e=(t+this._weekStart)%7,i=document.createElement("div");i.className="wd",i.textContent=new Intl.DateTimeFormat(void 0,{weekday:"narrow"}).format(new Date(2020,5,e+1)),this._grid.appendChild(i)}for(let t=0;t<s;t++)this._grid.appendChild(document.createElement("div"));for(let t=1;t<=r;t++){const s=new Date(e,i,t),r=document.createElement("button");if(r.className="day",r.textContent=String(t),s.toDateString()===a.toDateString()&&r.classList.add("today"),this.isRange){const t=this.value?new Date(this.value):null,e=this.rangeToValue?new Date(this.rangeToValue):null;t&&s.toDateString()===t.toDateString()&&r.classList.add("range-start"),e&&s.toDateString()===e.toDateString()&&r.classList.add("range-end"),t&&e&&s>t&&s<e&&r.classList.add("in-range")}else n&&s.toDateString()===n.toDateString()&&r.classList.add("selected");r.addEventListener("click",()=>{if(this.isRange){const t="date"===this.mode?new Date(s.getFullYear(),s.getMonth(),s.getDate()).toISOString():(()=>{const t=new Date;return t.setFullYear(s.getFullYear(),s.getMonth(),s.getDate()),"datetime"===this.mode&&t.setHours(9,0,0,0),t.toISOString()})();if("to"===this._currentField)this.rangeToValue=t,this.value&&new Date(t)<new Date(this.value)&&(this.rangeToValue=this.value,this.value=t);else{const e=!this.value&&!this.rangeToValue;this.value=t,this.rangeToValue&&new Date(t)>new Date(this.rangeToValue)&&(this.value=this.rangeToValue,this.rangeToValue=t),e&&(this._currentField="to",this._rangeState="selecting-to")}this._emitChange(),this._render(),this._updateFocusRing()}else if("date"===this.mode)this.value=new Date(s.getFullYear(),s.getMonth(),s.getDate()).toISOString(),this._emitChange(),this.close();else{const t=this.value?new Date(this.value):new Date;t.setFullYear(s.getFullYear(),s.getMonth(),s.getDate()),this.value=t.toISOString(),this._emitChange(),this._render()}}),this._grid.appendChild(r)}}_handleNavigation(t){this._navigationDirection=t;const e="next"===t?1:-1;({year:()=>this._view.setFullYear(this._view.getFullYear()+12*e),month:()=>this._view.setFullYear(this._view.getFullYear()+e),day:()=>this._view.setMonth(this._view.getMonth()+e)})[this._viewMode](),this._render()}_handlePrevClick(){this._handleNavigation("prev")}_handleNextClick(){this._handleNavigation("next")}_handleMonthYearClick(){"day"===this._viewMode?this._viewMode="month":"month"===this._viewMode&&(this._viewMode="year"),this._render()}_handleSwipe(){const t=this._touchEndX-this._touchStartX;Math.abs(t)<50||(t>0?this._handlePrevClick():this._handleNextClick())}_renderMonthPicker(){const t=this._view.getFullYear(),e=this.value?new Date(this.value):null,i=new Date;this._grid.innerHTML="",this._grid.classList.add("month-view"),this._grid.classList.remove("year-view");for(let a=0;a<12;a++){const n=new Date(t,a,1),s=document.createElement("button");s.className="month",s.textContent=new Intl.DateTimeFormat(void 0,{month:"short"}).format(n),n.getMonth()===i.getMonth()&&n.getFullYear()===i.getFullYear()&&s.classList.add("today"),e&&n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear()&&s.classList.add("selected"),s.addEventListener("click",()=>{this._view.setMonth(a),this._viewMode="day",this._render()}),this._grid.appendChild(s)}}_renderYearPicker(){const t=this._view.getFullYear(),e=this.value?new Date(this.value):null,i=new Date;this._grid.innerHTML="",this._grid.classList.add("year-view"),this._grid.classList.remove("month-view");const a=t-5;for(let t=0;t<12;t++){const n=a+t,s=document.createElement("button");s.className="year",s.textContent=String(n),n===i.getFullYear()&&s.classList.add("today"),e&&n===e.getFullYear()&&s.classList.add("selected"),s.addEventListener("click",()=>{this._view.setFullYear(n),this._viewMode="month",this._render()}),this._grid.appendChild(s)}}_renderTime(){const t="datetime"===this.mode||"time"===this.mode;if(this._timeWrap.hidden=!t,!t)return;"time"===this.mode?(this._timeWrap.style.borderTop="none",this._timeWrap.style.paddingTop="0"):(this._timeWrap.style.borderTop="",this._timeWrap.style.paddingTop="");const e="12"===this.timeFormat;this._ampm.hidden=!e,this._hourSelect.innerHTML="";const i=e?12:24,a=e?1:0;for(let t=a;t<(e?a+12:i);t++){const e=document.createElement("option");e.value=t,e.textContent=String(t).padStart(2,"0"),this._hourSelect.appendChild(e)}this._minuteSelect.innerHTML="";const n=this._step||15;for(let t=0;t<60;t+=n){const e=document.createElement("option");e.value=t,e.textContent=String(t).padStart(2,"0"),this._minuteSelect.appendChild(e)}let s;if(s=this.isRange&&"to"===this._currentField?this.rangeToValue:this.value,s){const t=new Date(s);if(e){let e=t.getHours();this._ampm.value=e>=12?"PM":"AM",e=e%12||12,this._hourSelect.value=e}else this._hourSelect.value=t.getHours();const i=t.getMinutes(),a=Math.round(i/n)*n;this._minuteSelect.value=a>=60?0:a}}_renderInput(){let t;if(t="date"===this.mode?{dateStyle:"medium"}:"time"===this.mode?{timeStyle:"short"}:{dateStyle:"medium",timeStyle:"short"},this.isRange){if(this.value){const e=new Date(this.value);this._input.textContent=new Intl.DateTimeFormat(void 0,t).format(e)}else{this._input.textContent="";const t="date"===this.mode?"Start date...":"time"===this.mode?"Start time...":"Start date & time...";this._input.setAttribute("data-placeholder",t)}if(this.rangeToValue){const e=new Date(this.rangeToValue);this._toInput.textContent=new Intl.DateTimeFormat(void 0,t).format(e)}else{this._toInput.textContent="";const t="date"===this.mode?"End date...":"time"===this.mode?"End time...":"End date & time...";this._toInput.setAttribute("data-placeholder",t)}}else if(this.value){const e=new Date(this.value);this._input.textContent=new Intl.DateTimeFormat(void 0,t).format(e)}else{this._input.textContent="";const t="date"===this.mode?"Select date...":"time"===this.mode?"Select time...":"Select date & time...";this._input.setAttribute("data-placeholder",t)}}_renderQuickDates(){const t=this.showQuickDates&&"time"!==this.mode;if(this._quickDates.hidden=!t,t){const t=this.quickDates.split(",").map(t=>t.trim()),e={yesterday:{days:-1,label:"Yesterday"},today:{days:0,label:"Today"},tomorrow:{days:1,label:"Tomorrow"}};this._quickDates.innerHTML="",t.forEach(t=>{if(e[t]){const i=document.createElement("button");i.className="preset",i.textContent=e[t].label,i.addEventListener("click",()=>{const i=new Date;i.setDate(i.getDate()+e[t].days),"date"===this.mode?this.value=new Date(i.getFullYear(),i.getMonth(),i.getDate()).toISOString():(i.setHours(9,0,0,0),this.value=i.toISOString()),this._viewMode="day",this._view=new Date(i),this._emitChange(),this._render(),"date"===this.mode&&this.close()}),this._quickDates.appendChild(i)}})}}_syncTime(){if("datetime"!==this.mode&&"time"!==this.mode)return;let t;t=this.isRange&&"to"===this._currentField?this.rangeToValue?new Date(this.rangeToValue):new Date:this.value?new Date(this.value):new Date;let e=parseInt(this._hourSelect.value)||0;const i=parseInt(this._minuteSelect.value)||0;if("12"===this.timeFormat){const t=this._ampm.value;"PM"===t&&12!==e&&(e+=12),"AM"===t&&12===e&&(e=0)}t.setHours(e,i,0,0),this.isRange&&"to"===this._currentField?this.rangeToValue=t.toISOString():this.value=t.toISOString(),this._emitChange(),this._renderInput()}_formatDate(t){if(!t||!this.format)return t;const e=new Date(t);if(isNaN(e.getTime()))return t;let i={iso:"yyyy-mm-dd","iso-tz":"yyyy-mm-ddThh:ii:sstzz","iso-datetime":"yyyy-mm-dd hh:ii:ss","iso-datetime-tz":"yyyy-mm-dd hh:ii:ss tz","us-date":"mm/dd/yyyy","us-datetime":"mm/dd/yyyy hh:ii:ss","us-datetime-tz":"mm/dd/yyyy hh:ii:ss tz","eu-date":"dd/mm/yyyy","eu-datetime":"dd/mm/yyyy hh:ii:ss","eu-datetime-tz":"dd/mm/yyyy hh:ii:ss tz",mysql:"yyyy-mm-dd hh:ii:ss"}[this.format]||this.format;const a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0"),d=String(e.getSeconds()).padStart(2,"0");return i.replace(/yyyy/g,a).replace(/mm/g,n).replace(/dd/g,s).replace(/hh/g,r).replace(/ii/g,o).replace(/ss/g,d).replace(/tzz/g,(()=>{const t=-e.getTimezoneOffset(),i=t>=0?"+":"-",a=Math.abs(t);return`${i}${String(Math.floor(a/60)).padStart(2,"0")}${String(a%60).padStart(2,"0")}`})()).replace(/tz/g,(()=>{const t=-e.getTimezoneOffset(),i=t>=0?"+":"-",a=Math.abs(t);return`${i}${String(Math.floor(a/60)).padStart(2,"0")}:${String(a%60).padStart(2,"0")}`})())}_ensureHidden(){this._hidden||(this._hidden=document.createElement("input"),this._hidden.type="hidden",this.appendChild(this._hidden)),this._hidden.name=this.name,this._hidden.value=this.format?this._formatDate(this.value):this.value,this.isRange&&this.rangeTo&&(this._hiddenTo||(this._hiddenTo=document.createElement("input"),this._hiddenTo.type="hidden",this.appendChild(this._hiddenTo)),this._hiddenTo.name=this.rangeTo,this._hiddenTo.value=this.format?this._formatDate(this.rangeToValue):this.rangeToValue)}_updateFocusRing(){this._input.classList.remove("is-focused"),this._toInput.classList.remove("is-focused"),this.isRange&&"to"===this._currentField?this._toInput.classList.add("is-focused"):this._input.classList.add("is-focused")}_emitChange(){this._hidden&&(this._hidden.value=this.format?this._formatDate(this.value):this.value),this._hiddenTo&&(this._hiddenTo.value=this.format?this._formatDate(this.rangeToValue):this.rangeToValue);const t=this.isRange?{value:this.value,toValue:this.rangeToValue,from:this.value,to:this.rangeToValue}:{value:this.value};this.dispatchEvent(new CustomEvent("change",{detail:t}))}}customElements.define("p-datetime",PDatetime);export{PDatetime as default};
