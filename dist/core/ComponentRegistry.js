class ComponentRegistry{constructor(e={}){this.basePath=e.basePath||"../components/",this.defaultPriority=e.defaultPriority||"normal",this.fileExtension=e.fileExtension||".js",this.useMinified=e.useMinified||!1,this.registry=[]}component(e,t,s={}){if(!s.loader)throw new Error(`Component '${e}' must provide a loader function`);const i={name:e,selector:t,priority:s.priority||this.defaultPriority,dependsOn:s.dependsOn,loader:s.loader};return this.registry.push(i),this}toPascalCase(e){return e.split(/[-_\s]+/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("")}build(){return[...this.registry]}clear(){return this.registry=[],this}getStats(){const e=this.registry.reduce((e,t)=>(e[t.priority]=(e[t.priority]||0)+1,e),{}),t=this.registry.filter(e=>e.dependsOn?.length>0).length;return{totalComponents:this.registry.length,priorities:e,withDependencies:t,basePath:this.basePath}}validate(){const e=new Set(this.registry.map(e=>e.name)),t=[],s=[];this.registry.forEach(s=>{s.dependsOn&&s.dependsOn.forEach(i=>{e.has(i)||t.push(`Component '${s.name}' depends on '${i}' which is not in the registry`)})});const i=this.detectCycles();i.length>0&&t.push(`Circular dependencies detected: ${i.join(", ")}`);const n=new Map;return this.registry.forEach(e=>{n.has(e.selector)?s.push(`Duplicate selector '${e.selector}' used by '${e.name}' and '${n.get(e.selector)}'`):n.set(e.selector,e.name)}),{valid:0===t.length,errors:t,warnings:s}}detectCycles(){const e=new Set,t=new Set,s=[],i=(n,r=[])=>{if(t.has(n)){const e=r.indexOf(n);return void s.push(r.slice(e).concat(n).join(" -> "))}if(e.has(n))return;e.add(n),t.add(n);const o=this.registry.find(e=>e.name===n);o?.dependsOn&&o.dependsOn.forEach(e=>{i(e,[...r,n])}),t.delete(n)};return this.registry.forEach(t=>{e.has(t.name)||i(t.name)}),s}fork(e={}){return new ComponentRegistry({basePath:this.basePath,defaultPriority:this.defaultPriority,fileExtension:this.fileExtension,useMinified:this.useMinified,...e})}static create(e="dev",t={}){const s={...{dev:{basePath:"/dist/esm/components/",useMinified:!1,fileExtension:".js"},production:{basePath:"/dist/esm/components/",useMinified:!0,fileExtension:".js"},custom:{}}[e],...t};return new ComponentRegistry(s)}}export{ComponentRegistry};
